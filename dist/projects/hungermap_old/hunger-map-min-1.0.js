HM={fenixMap:"",l:"",layers:[],selectedLayerIndex:0,boundaries:"",layerLang:"e",mapLang:"EN",layerHighlight:"",layersHashMap:{},rangesHM:[0,5,15,25,35],timeperiod:!1,selectedCountryCode:"",init:function(){for(var b="EN",a="100%",c="100%",e=300,d=[],f,h=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),g=0;g<h.length;g++)f=h[g].split("="),d.push(f[0]),d[f[0]]=f[1];d.height&&(c=d.height);d.width&&(a=d.width);"100%"==c&&(c=$(window).height()-30,e=c-300);d.lang&&(b=d.lang.toUpperCase());
switch(b){case "ES":HM.layerLang="s";HM.mapLang="ES";break;case "FR":HM.layerLang="f",HM.mapLang="FR"}$("#hm-container").width(a);$("#hm-map").width(a);$("#hm-container").height(c);$("#hm-map").height(e);$("#hm-logo").addClass("hm-logo-"+b);switch(b){case "FR":$("#hm-proportion").html("Proportion de la");$("#hm-title").html("Popolation Totale sous-aliment\u00e9e");$("#hm-timeline-title").html("Chronologie");$("#hm-legend").html("L\u00e9gende");$("#hm-verylow").html("Tr\u00e8s basse ");$("#hm-moderatelylow").html("Mod\u00e8r\u00e9ment basse");
$("#hm-moderatelyhigh").html("Mod\u00e8r\u00e9ment \u00e9lev\u00e9e ");$("#hm-high").html("\u00c9lev\u00e9e");$("#hm-veryhigh").html("Tr\u00e8s \u00e9lev\u00e9e");$("#hm-missing").html("Donn\u00e9es manquantes ou insuffisantes");$("#hm-andover").html("et plus");$("#hm-areaname").html("S\u00e9lectionnez un pays sur la carte pour en obtenir les d\u00e9tails");break;case "ES":$("#hm-proportion").html("Proporci\u00f3n de la");$("#hm-title").html("Poblaci\u00f3n Total Sub-alimentada");$("#hm-timeline-title").html("Cronolog\u00eda");
$("#hm-legend").html("Leyenda");$("#hm-verylow").html("Muy bajo");$("#hm-moderatelylow").html("Moderadamente bajo");$("#hm-moderatelyhigh").html("Moderadamente alto");$("#hm-high").html("Alto");$("#hm-veryhigh").html("Muy alto ");$("#hm-missing").html("Informaci\u00f3n ausente o insuficiente");$("#hm-andover").html("o m\u00e1s");$("#hm-areaname").html("Seleccionar un pa\u00eds en el mapa para obtener los detalles");break;default:$("#hm-proportion").html("Proportion Of"),$("#hm-title").html("Total Population Undernourished"),
$("#hm-timeline-title").html("Timeline"),$("#hm-legend").html("Legend"),$("#hm-verylow").html("Very low"),$("#hm-moderatelylow").html("Moderately low"),$("#hm-moderatelyhigh").html("Moderately high"),$("#hm-high").html("High"),$("#hm-veryhigh").html("Very high"),$("#hm-missing").html("Missing or insufficient data"),$("#hm-andover").html("and over"),$("#hm-areaname").html("Select a country on the map to get country details")}HM.createHungerMap("hm-map")},createHungerMap:function(b){b=new FM.Map(b,
{plugins:{geosearch:!1,mouseposition:!1,controlloading:!0,zoomControl:"bottomright"},guiController:{overlay:!1,baselayer:!1,wmsLoader:!1,enablegfi:!1},gui:{disclaimerfao:!0,fullscreen:!1}},{zoom:2,zoomControl:!1,attributionControl:!1});b.createMap();b.lang=HM.mapLang;HM.fenixMap=b;HM.fenixMap.map.on("click",function(a){var b=a.target._fenixMap,d=b.controller.selectedLayer;d&&HMRequests.countryGFI(d,a.layerPoint,a.latlng,b.map,d.layer.joincolumn)});var a=this.createBaseLayer("ESRI_WORLDSTREETMAP",
"EN");b.addTileLayer(a,!0);a={layertitle:"GHG",layers:"gaul0_faostat_3857",layername:"gaul0_faostat_3857",classification:"custom",joinboundary:"FAOSTAT",joincolumn:"faost_code",mu:"Gigagrams",ranges:"-1,0.1,15,25,35",colors:"ffffff,c4c8cb,fbc0bf,f69291,ee5552,ad2026",legendtitle:""};a.lang=HM.layerLang;a.jointype="shaded";a.layertype="JOIN";a.defaultgfi=!0;a.srs="EPSG:3857";HM.l=new FM.layer(a,b);HM.l.zindex=102;a=new FM.layer({layername:"gaul0_line_3857",layertitle:"Boundaries",style:"",urlWMS:"http://fenix.fao.org/geo",
srs:"EPSG:3857",opacity:"0.9"},b);HM.boundaries=a;HM.boundaries.zindex=104;b.addLayerWMS(a);HMRequests.getElements(HM_CONFIG.ITEMCODE,HM.layerLang);HM.layerHighlight=new FM.layer({layertitle:"GHG",urlWMS:"http://hqlprfenixapp1.hq.un.fao.org:10090/geoserver/wms",layername:"gaul0_faostat_3857",style:"gaul0_highlight_polygon",srs:"EPSG:3857",opacity:"0.9",cql_filter:"faost_code IN (1)"},b);HM.layerHighlight.zindex=104;$("#"+HM.fenixMap.mapContainerID).append("<div class='fm-fullscreen fm-btn fm-btnIcon'><div class='fm-icon-fullscreen' id='hm-fullscreen'><div></div>");
$("#hm-fullscreen").on("click",function(){var a="";"EN"!=HM.mapLang.toUpperCase()&&(a="?lang="+HM.mapLang.toUpperCase());window.open(HM_CONFIG.BASE_URL+a)});$("#hm-timeline-title").on("click",function(){HM.timeperiod?(HM.timeperiod=!1,clearInterval(HM.interval)):(HM.timeperiod=!0,HM.interval=setInterval(function(){var a=HM.selectedLayerIndex-1;-1>=a&&(a=HM.layers.length-1);HM.switchLayer(a)},3E3))})},switchLayer:function(b){for(var a=0;a<HM.layers.length;a++)b!=a&&$("#hm-timeline-"+a).removeClass("hm-timeline-selected");
$("#hm-timeline-"+b).addClass("hm-timeline-selected");HM.layerHighlight.removeLayer();var a=HM.layers[HM.selectedLayerIndex],c=HM.layers[b];HM.selectedLayerIndex=b;a.removeLayer();HM.fenixMap.createShadedLayerRequestCached(c);HM.fenixMap.controller.selectedLayer=c;HM.selectedCountryCode&&HMRequests.getCountryDetails(HM.map,HM_CONFIG.ITEMCODE,HM.layersHashMap[HM.selectedLayerIndex],HM.selectedCountryCode,HM.layerLang,null)},highlightCountry:function(b){var a=HM.layerHighlight;a.removeLayer();a.layer.cql_filter=
"faost_code IN ("+b+")";HM.fenixMap.addLayerWMS(HM.layerHighlight)},createBaseLayer:function(b,a){var c={};c.layername=b;c.layertype="TILE";c.lang=a;var e=new FM.TileLayer(c);e.leafletLayer=e.createTileLayer(c.layername);return e}};